<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI Leadership Balancer - Bì¡°</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- SheetJS (ì—‘ì…€ ì—…ë¡œë“œ/ë‹¤ìš´ë¡œë“œìš©) -->
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>

    <!-- Custom Colors Configuration -->
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              main: "#A50034", // R165 G0 B52
              sub: "#6B6B6B", // R107 G107 B107
            },
          },
        },
      };
    </script>

    <style>
      @import url("https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css");

      body {
        font-family: "Pretendard", sans-serif;
      }

      /* Scrollbar Custom */
      ::-webkit-scrollbar {
        width: 8px;
      }
      ::-webkit-scrollbar-track {
        background: #f1f1f1;
      }
      ::-webkit-scrollbar-thumb {
        background: #ccc;
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #a50034;
      }

      .sidebar-item.active {
        background-color: white;
        color: #a50034;
        font-weight: 700;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      }

      .sidebar-item:not(.active):hover {
        background-color: rgba(255, 255, 255, 0.1);
      }

      .fade-in {
        animation: fadeIn 0.3s ease-in-out;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(5px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* =========================
           í•™ìƒ ê´€ë¦¬(ì—‘ì…€) í™”ë©´ ì „ìš© ìŠ¤íƒ€ì¼
           ì›ë³¸ practice_for_excel_inputation ê¸°ë°˜
           ========================= */
      .student-layout {
        display: flex;
        flex-direction: row;
        gap: 24px;
      }
      .student-layout .card {
        background: #fff;
        border-radius: 16px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
        padding: 20px 24px;
      }
      .student-layout .form-card {
        flex: 1;
        max-width: 580px;
      }
      .student-layout h1 {
        margin: 0 0 8px 0;
        font-size: 24px;
        font-weight: 700;
      }
      .student-layout h2 {
        margin: 8px 0 16px 0;
        font-size: 18px;
      }
      .student-layout .subtitle {
        margin-bottom: 20px;
        color: #666;
        font-size: 13px;
      }
      .student-layout .form-grid {
        display: grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        gap: 12px 16px;
      }
      .student-layout .form-field {
        display: flex;
        flex-direction: column;
        gap: 4px;
        font-size: 13px;
      }
      .student-layout .form-field label {
        font-weight: 600;
      }
      .student-layout .form-field span.hint {
        font-size: 11px;
        color: #888;
      }
      .student-layout input[type="text"],
      .student-layout input[type="tel"],
      .student-layout input[type="password"],
      .student-layout select {
        border-radius: 8px;
        border: 1px solid #d4d7e5;
        padding: 8px 10px;
        font-size: 13px;
        outline: none;
        transition: border-color 0.15s ease, box-shadow 0.15s ease;
      }
      .student-layout input:focus,
      .student-layout select:focus {
        border-color: #4460ff;
        box-shadow: 0 0 0 2px rgba(68, 96, 255, 0.15);
      }
      .student-layout .form-actions {
        margin-top: 18px;
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        align-items: center;
      }
      .student-layout button {
        border: none;
        border-radius: 999px;
        padding: 10px 18px;
        font-size: 13px;
        cursor: pointer;
        font-weight: 600;
        display: inline-flex;
        align-items: center;
        gap: 6px;
        transition: transform 0.05s, box-shadow 0.1s, background 0.15s;
      }
      .student-layout #add-student-button {
        background: #4460ff;
        color: #fff;
        box-shadow: 0 8px 16px rgba(68, 96, 255, 0.35);
      }
      .student-layout #add-student-button:hover {
        background: #3650e0;
      }
      .student-layout #add-student-button:active {
        transform: translateY(1px);
        box-shadow: 0 4px 10px rgba(68, 96, 255, 0.3);
      }
      .student-layout .secondary-btn {
        background: #eef1ff;
        color: #3a4ad9;
        box-shadow: none;
      }
      .student-layout .secondary-btn:hover {
        background: #e1e6ff;
      }
      .student-layout .status-text {
        font-size: 12px;
        color: #666;
      }

      .student-list-panel {
        position: relative;
        width: 480px;
        max-height: 600px;
        overflow: hidden;
        display: flex;
        flex-direction: column;
      }
      .student-list-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 8px;
        gap: 8px;
      }
      .student-list-title {
        font-size: 16px;
        font-weight: 700;
      }
      .student-count-badge {
        background: #eef1ff;
        color: #3a4ad9;
        border-radius: 999px;
        padding: 3px 10px;
        font-size: 11px;
        font-weight: 600;
      }
      .student-table-container {
        flex: 1;
        overflow: auto;
        border-radius: 12px;
        border: 1px solid #e1e3f0;
      }
      .student-table-container table {
        width: 100%;
        border-collapse: collapse;
        font-size: 12px;
      }
      .student-table-container thead {
        position: sticky;
        top: 0;
        background: #f4f5fd;
        z-index: 1;
      }
      .student-table-container th,
      .student-table-container td {
        padding: 6px 8px;
        border-bottom: 1px solid #eceef7;
        text-align: left;
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow: hidden;
        max-width: 120px;
      }
      .student-table-container th {
        font-weight: 600;
        font-size: 11px;
        color: #555;
      }
      .student-table-container tbody tr:nth-child(even) {
        background: #fcfcff;
      }
      .student-table-container tbody tr:hover {
        background: #f1f3ff;
      }
      .student-layout #excel-bulk-input-area {
        width: 99%;
        min-height: 74px;
        box-sizing: border-box;
        resize: vertical;
        background: #f1f5fa;
        margin-top: 0.5em;
        margin-bottom: 2px;
      }

      @media (max-width: 1100px) {
        .student-layout {
          flex-direction: column;
        }
        .student-layout .form-card {
          max-width: 100%;
        }
        .student-list-panel {
          width: 100%;
          max-height: none;
        }
      }
    </style>
  </head>
  <body class="bg-slate-50 text-slate-900 h-screen flex overflow-hidden">
    <!-- Sidebar -->
    <div
      class="w-64 bg-main text-white flex-shrink-0 flex flex-col transition-all duration-300 hidden md:flex"
      id="sidebar"
    >
      <div class="p-6 flex items-center justify-between">
        <div class="flex items-center space-x-2">
          <i data-lucide="brain" class="text-white" width="28" height="28"></i>
          <span class="text-xl font-bold leading-tight"
            >Leadership<br />Balancer</span
          >
        </div>
      </div>

      <nav class="flex-1 px-4 space-y-2">
        <button
          onclick="switchTab('dashboard')"
          class="sidebar-item active w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors text-left"
        >
          <i data-lucide="layout-dashboard" width="20"></i>
          <span>ëŒ€ì‹œë³´ë“œ</span>
        </button>
        <button
          onclick="switchTab('fairness')"
          class="sidebar-item w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors text-left text-white/80"
        >
          <i data-lucide="scale" width="20"></i>
          <span>ê³µì •ì„± í™•ë³´</span>
        </button>
        <button
          onclick="switchTab('relationship')"
          class="sidebar-item w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors text-left text-white/80"
        >
          <i data-lucide="message-circle-heart" width="20"></i>
          <span>ê´€ê³„ ê°œì„ </span>
        </button>
        <button
          onclick="switchTab('time')"
          class="sidebar-item w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors text-left text-white/80"
        >
          <i data-lucide="clock" width="20"></i>
          <span>ì‹œê°„ í™•ë³´</span>
        </button>
        <!-- ìƒˆ íƒ­: í•™ìƒ ê´€ë¦¬ -->
        <button
          onclick="switchTab('students')"
          class="sidebar-item w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors text-left text-white/80"
        >
          <i data-lucide="users" width="20"></i>
          <span>í•™ìƒ ê´€ë¦¬</span>
        </button>
      </nav>

      <div class="p-6 border-t border-white/20">
        <div class="bg-black/20 p-4 rounded-lg relative">
          <div class="flex justify-between items-center mb-2">
            <p class="text-xs text-white/80">ë‚˜ì˜ ë¦¬ë”ì‹­ ì—ë„ˆì§€</p>
            <i
              data-lucide="help-circle"
              width="12"
              class="text-white/60 cursor-pointer"
            ></i>
          </div>

          <div class="flex items-center space-x-3">
            <div id="mascot-small"></div>
            <div class="flex-1">
              <div class="flex items-end space-x-2 mb-1">
                <span class="text-2xl font-bold text-green-400">85%</span>
                <span class="text-xs text-green-400 mb-1">â–² ì•ˆì •ì </span>
              </div>
              <div class="w-full bg-black/30 rounded-full h-2">
                <div
                  class="bg-green-400 h-2 rounded-full"
                  style="width: 85%"
                ></div>
              </div>
            </div>
          </div>
          <p class="text-[10px] text-white/70 mt-2 text-center">
            "ë¦¬ë”ë‹˜! ì˜¤ëŠ˜ë„ ì•„ì£¼ í›Œë¥­í•´ìš”! ğŸ¶"
          </p>
        </div>
      </div>
    </div>

    <!-- Main Content -->
    <div class="flex-1 flex flex-col h-full overflow-hidden relative">
      <!-- Mobile Header -->
      <header
        class="md:hidden bg-white border-b border-slate-200 p-4 flex justify-between items-center z-10"
      >
        <div class="flex items-center space-x-2">
          <i data-lucide="brain" class="text-main"></i>
          <span class="font-bold text-lg text-main">Leadership Balancer</span>
        </div>
        <button onclick="toggleSidebar()" class="text-sub">
          <i data-lucide="menu"></i>
        </button>
      </header>

      <!-- Main Scroll Area -->
      <main class="flex-1 overflow-auto p-4 md:p-8 bg-slate-50">
        <div class="max-w-6xl mx-auto h-full" id="content-area">
          <!-- 1. Dashboard View -->
          <div id="view-dashboard" class="fade-in space-y-6">
            <header
              class="flex justify-between items-center bg-white p-6 rounded-xl shadow-sm border border-slate-100"
            >
              <div class="flex items-center space-x-4">
                <div
                  class="bg-yellow-100 p-2 rounded-full"
                  id="mascot-dashboard"
                ></div>
                <div>
                  <h2 class="text-2xl font-bold text-slate-800">
                    Bì¡°ì„¸ê³„ìµœê³  ë¦¬ë”ë‹˜, ë°˜ê°€ì›Œìš”! ğŸ¾
                  </h2>
                  <p class="text-sm text-sub mt-1">
                    AI íŒ©íŠ¸ ì‹œíŠ¸ì™€ ê³¨ë“ íƒ€ì„ ì•Œë¦¼ìœ¼ë¡œ ì˜¤ëŠ˜ë„ íŒ€ì„ ì™„ë²½í•˜ê²Œ
                    ì¼€ì–´í•´ë³¼ê¹Œìš”?
                  </p>
                </div>
              </div>
              <span
                class="text-sm text-sub bg-slate-50 px-3 py-1 rounded-full"
                id="current-date"
              ></span>
            </header>

            <!-- KPI Cards -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
              <div
                class="bg-white p-6 rounded-xl shadow-sm border border-slate-100 hover:shadow-md transition-shadow"
              >
                <div class="flex items-center justify-between mb-4">
                  <div class="p-3 bg-main/10 text-main rounded-lg">
                    <i data-lucide="scale" width="24"></i>
                  </div>
                  <span
                    class="text-xs font-medium text-sub bg-slate-100 px-2 py-1 rounded"
                    >ì—…ë°ì´íŠ¸ í•„ìš”</span
                  >
                </div>
                <h3 class="text-lg font-semibold text-slate-700 mb-1">
                  ì„±ê³¼ ê°ê´€í™”
                </h3>
                <p class="text-sm text-sub">
                  4ëª…ì˜ íŒ€ì›ì— ëŒ€í•œ<br />ë‚œì´ë„ ë³´ì • ë°ì´í„°ê°€ ìˆìŠµë‹ˆë‹¤.
                </p>
                <button
                  onclick="switchTab('fairness')"
                  class="mt-4 text-sm text-main font-medium flex items-center hover:underline"
                >
                  í™•ì¸í•˜ê¸°
                  <i data-lucide="chevron-right" width="16" class="ml-1"></i>
                </button>
              </div>

              <div
                class="bg-white p-6 rounded-xl shadow-sm border border-slate-100 hover:shadow-md transition-shadow"
              >
                <div class="flex items-center justify-between mb-4">
                  <div class="p-3 bg-pink-50 text-pink-600 rounded-lg">
                    <i data-lucide="message-circle-heart" width="24"></i>
                  </div>
                  <span
                    class="text-xs font-medium text-pink-600 bg-pink-50 px-2 py-1 rounded animate-pulse"
                    >4ê±´ ëŒ€ê¸°ì¤‘</span
                  >
                </div>
                <h3 class="text-lg font-semibold text-slate-700 mb-1">
                  í”¼ë“œë°± ê³¨ë“ íƒ€ì„
                </h3>
                <p class="text-sm text-sub">
                  ì¹­ì°¬ íƒ€ì´ë°ì„ ë†“ì¹˜ì§€ ë§ˆì„¸ìš”.<br />ì§€ê¸ˆ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ë³´ì„¸ìš”.
                </p>
                <button
                  onclick="switchTab('relationship')"
                  class="mt-4 text-sm text-pink-600 font-medium flex items-center hover:underline"
                >
                  ë©”ì‹œì§€ ì‘ì„±
                  <i data-lucide="chevron-right" width="16" class="ml-1"></i>
                </button>
              </div>

              <div
                class="bg-white p-6 rounded-xl shadow-sm border border-slate-100 hover:shadow-md transition-shadow"
              >
                <div class="flex items-center justify-between mb-4">
                  <div class="p-3 bg-indigo-50 text-indigo-600 rounded-lg">
                    <i data-lucide="clock" width="24"></i>
                  </div>
                </div>
                <h3 class="text-lg font-semibold text-slate-700 mb-1">
                  ìŠ¤ë§ˆíŠ¸ ì›Œí¬ë¡œë“œ
                </h3>
                <p class="text-sm text-sub">
                  ì½ì§€ ì•Šì€ ë³´ê³ ì„œ 2ê±´ ìš”ì•½ ì™„ë£Œ.<br />íšŒì˜ ì¼ì • ì¶©ëŒ 1ê±´ ê°ì§€.
                </p>
                <button
                  onclick="switchTab('time')"
                  class="mt-4 text-sm text-indigo-600 font-medium flex items-center hover:underline"
                >
                  ì¼ì • ì¡°ìœ¨í•˜ê¸°
                  <i data-lucide="chevron-right" width="16" class="ml-1"></i>
                </button>
              </div>
            </div>

            <!-- Leader Care Section -->
            <div
              class="bg-white rounded-xl shadow-sm border border-slate-100 p-6 transition-opacity duration-500"
              id="care-section"
            >
              <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold text-slate-800 flex items-center">
                  <span id="mascot-care" class="mr-2"></span>
                  <span>ğŸŒ¿ ë¦¬ë”ë¥¼ ìœ„í•œ íë§ í•œ ì¡°ê°</span>
                </h3>
                <button
                  onclick="rotateTip()"
                  class="text-xs flex items-center text-sub hover:text-slate-800 transition-colors"
                >
                  <i
                    data-lucide="refresh-cw"
                    width="14"
                    class="mr-1"
                    id="refresh-icon"
                  ></i>
                  ë‹¤ë¥¸ ê¿€íŒ ë³´ê¸°
                </button>
              </div>
              <div
                id="care-content-area"
                class="flex items-start p-4 rounded-xl bg-amber-50"
              >
                <!-- Dynamic Content -->
              </div>
            </div>

            <!-- Recent Alerts -->
            <div
              class="bg-white rounded-xl shadow-sm border border-slate-100 p-6"
            >
              <h3 class="text-lg font-bold text-slate-800 mb-4">
                ìµœê·¼ AI ì•Œë¦¼
              </h3>
              <div class="space-y-4">
                <div
                  class="flex items-start space-x-4 p-4 bg-slate-50 rounded-lg hover:bg-slate-100 transition-colors"
                >
                  <div
                    class="mt-1 p-2 rounded-full bg-green-100 text-green-600"
                  >
                    <i data-lucide="check-circle-2" width="18"></i>
                  </div>
                  <div class="flex-1">
                    <div class="flex justify-between items-center mb-1">
                      <h4 class="font-semibold text-slate-800">ì¹­ì°¬ ì¶”ì²œ</h4>
                      <span class="text-xs text-sub">10ë¶„ ì „</span>
                    </div>
                    <p class="text-sm text-slate-600 mb-2">
                      <strong>í•˜ìœ ë¦¼</strong>ë‹˜ì´ ì˜ˆì •ë³´ë‹¤ 2ì¼ ë¹ ë¥´ê²Œ í•µì‹¬
                      ë‚œì œë¥¼ í•´ê²°í–ˆìŠµë‹ˆë‹¤. ì¹­ì°¬í•  ê³¨ë“ íƒ€ì„ì…ë‹ˆë‹¤!
                    </p>
                    <button
                      onclick="setFeedbackTarget('í•˜ìœ ë¦¼'); switchTab('relationship');"
                      class="text-xs bg-white border border-slate-200 px-3 py-1.5 rounded shadow-sm hover:bg-slate-50 text-sub font-medium"
                    >
                      AI ì´ˆì•ˆ ë³´ê¸°
                    </button>
                  </div>
                </div>

                <div
                  class="flex items-start space-x-4 p-4 bg-slate-50 rounded-lg hover:bg-slate-100 transition-colors"
                >
                  <div
                    class="mt-1 p-2 rounded-full bg-green-100 text-green-600"
                  >
                    <i data-lucide="check-circle-2" width="18"></i>
                  </div>
                  <div class="flex-1">
                    <div class="flex justify-between items-center mb-1">
                      <h4 class="font-semibold text-slate-800">ë¦¬ë”ì‹­ ê²©ë ¤</h4>
                      <span class="text-xs text-sub">2ì‹œê°„ ì „</span>
                    </div>
                    <p class="text-sm text-slate-600 mb-2">
                      <strong>ë°•íƒœí¬</strong>ë‹˜ì´ ì „ì‚¬ ë°œí‘œë¥¼ ì„±ê³µì ìœ¼ë¡œ
                      ë§ˆì³¤ìŠµë‹ˆë‹¤. ë¦¬ë”ì‹­ì— ëŒ€í•œ ê²©ë ¤ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ë³´ì„¸ìš”.
                    </p>
                    <button
                      onclick="setFeedbackTarget('ë°•íƒœí¬'); switchTab('relationship');"
                      class="text-xs bg-white border border-slate-200 px-3 py-1.5 rounded shadow-sm hover:bg-slate-50 text-sub font-medium"
                    >
                      AI ì´ˆì•ˆ ë³´ê¸°
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- 2. Fairness Module View -->
          <div
            id="view-fairness"
            class="hidden fade-in h-full flex flex-col space-y-6"
          >
            <header>
              <h2 class="text-2xl font-bold text-slate-800 mb-1">
                AI ì„±ê³¼ ê°ê´€í™” íŒ©íŠ¸ ì‹œíŠ¸
              </h2>
              <p class="text-sub">
                ì •ì„±ì  ë°ì´í„°ë¥¼ ë¶„ì„í•˜ì—¬ ë‚œì´ë„ë¥¼ ë³´ì •í•˜ê³  ê°ê´€ì ì¸ ì„±ê³¼ ì§€í‘œë¥¼
                ì œê³µí•©ë‹ˆë‹¤.
              </p>
            </header>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 h-full">
              <!-- Team List -->
              <div
                class="bg-white rounded-xl shadow-sm border border-slate-100 p-4"
              >
                <h3 class="font-semibold text-slate-700 mb-4 px-2">
                  íŒ€ì› ëª©ë¡
                </h3>
                <div class="space-y-2" id="team-list-container"></div>
              </div>

              <!-- Detail View -->
              <div
                class="lg:col-span-2 bg-white rounded-xl shadow-sm border border-slate-100 p-6 flex flex-col"
                id="fairness-detail"
              ></div>
            </div>
          </div>

          <!-- 3. Relationship Module View -->
          <div
            id="view-relationship"
            class="hidden fade-in h-full flex flex-col space-y-6"
          >
            <header>
              <h2 class="text-2xl font-bold text-slate-800 mb-1">
                í”¼ë“œë°± ê³¨ë“ íƒ€ì„ ì½”ì¹˜
              </h2>
              <p class="text-sub">
                ë†“ì¹˜ê¸° ì‰¬ìš´ ì¹­ì°¬ íƒ€ì´ë°ì„ ì¡ê³ , ìƒí™©ì— ë§ëŠ” ì™„ë²½í•œ ë©”ì‹œì§€ë¥¼ AIê°€
                ì œì•ˆí•©ë‹ˆë‹¤.
              </p>
            </header>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
              <!-- Alerts -->
              <div
                class="bg-white rounded-xl shadow-sm border border-slate-100 p-6"
              >
                <h3 class="font-semibold text-slate-700 mb-4 flex items-center">
                  <i
                    data-lucide="bell"
                    width="18"
                    class="mr-2 text-pink-500"
                  ></i>
                  í”¼ë“œë°± ì¶”ì²œ ì•Œë¦¼
                </h3>
                <div class="space-y-4 overflow-y-auto max-h-[400px] pr-2">
                  <!-- Ha Yu-rim -->
                  <div
                    id="alert-hayurim"
                    class="p-4 border bg-pink-50 border-pink-100 ring-2 ring-pink-200 rounded-lg cursor-pointer transition-all mb-3"
                    onclick="setFeedbackTarget('í•˜ìœ ë¦¼')"
                  >
                    <div class="flex justify-between items-start mb-2">
                      <span class="font-bold text-slate-800"
                        >í•˜ìœ ë¦¼ (ìŠˆí¼ í¬ë™)</span
                      >
                      <span
                        class="text-xs text-pink-600 bg-white px-2 py-1 rounded-full font-medium"
                        >ì¦‰ì‹œ ì¹­ì°¬ í•„ìš”</span
                      >
                    </div>
                    <p class="text-sm text-slate-700 mb-3">
                      ë§ˆê°ì¼ë³´ë‹¤ 2ì¼ ì¼ì° ì—…ë¬´ë¥¼ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤. ì§€ê¸ˆ ì¹­ì°¬í•˜ë©´
                      ë™ê¸°ë¶€ì—¬ íš¨ê³¼ê°€ 200% ìƒìŠ¹í•©ë‹ˆë‹¤.
                    </p>
                    <div class="text-xs text-sub">ë°œìƒ ì‹œê°: 10ë¶„ ì „</div>
                  </div>

                  <!-- Park Tae-hee -->
                  <div
                    id="alert-parktaehee"
                    class="p-4 border border-slate-200 bg-white rounded-lg hover:bg-slate-50 cursor-pointer transition-all mb-3"
                    onclick="setFeedbackTarget('ë°•íƒœí¬')"
                  >
                    <div class="flex justify-between items-start mb-2">
                      <span class="font-bold text-slate-800"
                        >ë°•íƒœí¬ (ë©‹ì§„ íŒ€ì¥ë‹˜)</span
                      >
                      <span
                        class="text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded-full font-medium"
                        >ë¦¬ë”ì‹­ ê²©ë ¤</span
                      >
                    </div>
                    <p class="text-sm text-slate-700 mb-3">
                      ì „ì‚¬ ë¹„ì „ ë°œí‘œë¥¼ ì„±ê³µì ìœ¼ë¡œ ë§ˆì³¤ìŠµë‹ˆë‹¤. ë©‹ì§„ ë¦¬ë”©ì— ëŒ€í•´
                      ê°ì‚¬ë¥¼ í‘œí•´ë³´ì„¸ìš”.
                    </p>
                    <div class="text-xs text-sub">ë°œìƒ ì‹œê°: 2ì‹œê°„ ì „</div>
                  </div>

                  <!-- Park Jeong-ho -->
                  <div
                    id="alert-parkjeongho"
                    class="p-4 border border-slate-200 bg-white rounded-lg hover:bg-slate-50 cursor-pointer transition-all mb-3"
                    onclick="setFeedbackTarget('ë°•ì •í˜¸')"
                  >
                    <div class="flex justify-between items-start mb-2">
                      <span class="font-bold text-slate-800"
                        >ë°•ì •í˜¸ (ìš°ë¦¬ì¡° ìƒ¤í¬)</span
                      >
                      <span
                        class="text-xs text-indigo-600 bg-indigo-50 px-2 py-1 rounded-full font-medium"
                        >ì¸ì‚¬ì´íŠ¸ ì¸ì •</span
                      >
                    </div>
                    <p class="text-sm text-slate-700 mb-3">
                      ê²½ìŸì‚¬ ë¶„ì„ ë¦¬í¬íŠ¸ì—ì„œ ë†€ë¼ìš´ í†µì°°ë ¥ì„ ë³´ì—¬ì£¼ì—ˆìŠµë‹ˆë‹¤.
                      ì „ë¬¸ì„±ì„ ì¸ì •í•´ ì£¼ì„¸ìš”.
                    </p>
                    <div class="text-xs text-sub">ë°œìƒ ì‹œê°: 4ì‹œê°„ ì „</div>
                  </div>

                  <!-- Park Jae-hyun -->
                  <div
                    id="alert-parkjaehyun"
                    class="p-4 border border-slate-200 bg-white rounded-lg hover:bg-slate-50 cursor-pointer transition-all"
                    onclick="setFeedbackTarget('ë°•ì¬í˜„')"
                  >
                    <div class="flex justify-between items-start mb-2">
                      <span class="font-bold text-slate-800"
                        >ë°•ì¬í˜„ (ë¶„ìœ„ê¸° ë©”ì´ì»¤)</span
                      >
                      <span
                        class="text-xs text-slate-500 bg-slate-100 px-2 py-1 rounded-full"
                        >ë¶„ìœ„ê¸° ë©”ì´ì»¤</span
                      >
                    </div>
                    <p class="text-sm text-slate-700 mb-3">
                      íŒ€ ì´ë²¤íŠ¸ ê¸°íšìœ¼ë¡œ ê³ ìƒí•˜ì…¨ìŠµë‹ˆë‹¤. ë°ì€ ì—ë„ˆì§€ì— ëŒ€í•´
                      ê°ì‚¬ë¥¼ ì „í•˜ì„¸ìš”.
                    </p>
                    <div class="text-xs text-sub">ë°œìƒ ì‹œê°: 9ì‹œê°„ ì „</div>
                  </div>
                </div>
              </div>

              <!-- Generator -->
              <div
                class="bg-white rounded-xl shadow-sm border border-slate-100 p-6 flex flex-col"
              >
                <h3 class="font-semibold text-slate-700 mb-4 flex items-center">
                  <i data-lucide="brain" width="18" class="mr-2 text-main"></i>
                  <span id="generator-title">AI ë©”ì‹œì§€ ìƒì„±ê¸° (í•˜ìœ ë¦¼ë‹˜)</span>
                </h3>

                <div class="flex space-x-2 mb-4">
                  <button
                    onclick="generateMessage('formal')"
                    class="flex-1 py-2 text-sm rounded-lg border border-slate-200 hover:bg-slate-50 transition-colors"
                  >
                    ì •ì¤‘í•œ/ê³µì‹ì 
                  </button>
                  <button
                    onclick="generateMessage('friendly')"
                    class="flex-1 py-2 text-sm rounded-lg border border-main bg-main text-white"
                  >
                    ì¹œê·¼í•œ/ë¶€ë“œëŸ¬ìš´
                  </button>
                  <button
                    onclick="generateMessage('cheer')"
                    class="flex-1 py-2 text-sm rounded-lg border border-slate-200 hover:bg-slate-50 transition-colors"
                  >
                    ê²©ë ¤/ì—ë„ˆì§€
                  </button>
                </div>

                <div
                  class="flex-1 bg-slate-50 rounded-lg border border-slate-200 p-4 mb-4 relative min-h-[150px]"
                  id="message-area"
                >
                  <textarea
                    class="w-full h-full bg-transparent border-none resize-none focus:ring-0 text-slate-700 leading-relaxed outline-none"
                    id="message-input"
                  >
ìœ„ ë²„íŠ¼ì„ ëˆŒëŸ¬ AIì—ê²Œ ì´ˆì•ˆ ì‘ì„±ì„ ìš”ì²­í•˜ì„¸ìš”.</textarea
                  >
                </div>

                <button
                  class="w-full bg-main hover:bg-red-800 text-white py-3 rounded-lg font-medium flex items-center justify-center transition-colors"
                >
                  <i data-lucide="send" width="18" class="mr-2"></i>
                  ë©”ì‹ ì €ë¡œ ì „ì†¡í•˜ê¸°
                </button>
              </div>
            </div>
          </div>

          <!-- 4. Time Module View -->
          <div
            id="view-time"
            class="hidden fade-in h-full flex flex-col space-y-6"
          >
            <header>
              <h2 class="text-2xl font-bold text-slate-800 mb-1">
                ìŠ¤ë§ˆíŠ¸ ì›Œí¬ë¡œë“œ ë§¤ë‹ˆì €
              </h2>
              <p class="text-sub">
                í–‰ì • ì—…ë¬´ ìë™í™”ì™€ ì •ë³´ ê²€ìƒ‰ ì§€ì›ìœ¼ë¡œ ë¦¬ë”ì˜ ì „ëµì  ì‹œê°„ì„
                í™•ë³´í•©ë‹ˆë‹¤.
              </p>
            </header>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
              <!-- News Section -->
              <div
                class="lg:col-span-3 bg-white rounded-xl shadow-sm border border-slate-100 p-6"
              >
                <h3 class="font-semibold text-slate-700 mb-4 flex items-center">
                  <i
                    data-lucide="newspaper"
                    width="18"
                    class="mr-2 text-orange-500"
                  ></i>
                  ğŸŒ ëª¨ë‹ AI ë¸Œë¦¬í•‘ (ì‚°ì—… ë‰´ìŠ¤ & í‚¤ì›Œë“œ)
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <!-- News List -->
                  <div class="space-y-3">
                    <div
                      class="p-3 bg-slate-50 rounded-lg border border-slate-100 hover:bg-slate-100 transition-colors"
                    >
                      <div class="flex items-center mb-1">
                        <span
                          class="text-[10px] font-bold bg-white border border-slate-200 px-1.5 py-0.5 rounded text-sub mr-2"
                          >ê²½ìŸì‚¬ ë™í–¥</span
                        >
                        <h4 class="text-sm font-bold text-slate-800 truncate">
                          ê¸€ë¡œë²Œ ë°°í„°ë¦¬ ì‹œì¥, ì „ê³ ì²´ ê¸°ìˆ  ê²½ìŸ ì‹¬í™”
                        </h4>
                      </div>
                      <p
                        class="text-xs text-slate-600 leading-relaxed line-clamp-2"
                      >
                        ì£¼ìš” ê²½ìŸì‚¬ë“¤ì´ 2027ë…„ ì–‘ì‚°ì„ ëª©í‘œë¡œ R&D íˆ¬ìë¥¼ 15%
                        í™•ëŒ€í–ˆìŠµë‹ˆë‹¤. ì°¨ì„¸ëŒ€ ë¼ì¸ ì„ ì ì´ ê´€ê±´ì…ë‹ˆë‹¤.
                      </p>
                    </div>
                    <div
                      class="p-3 bg-slate-50 rounded-lg border border-slate-100 hover:bg-slate-100 transition-colors"
                    >
                      <div class="flex items-center mb-1">
                        <span
                          class="text-[10px] font-bold bg-white border border-slate-200 px-1.5 py-0.5 rounded text-sub mr-2"
                          >ê¸°ìˆ  íŠ¸ë Œë“œ</span
                        >
                        <h4 class="text-sm font-bold text-slate-800 truncate">
                          ìƒì„±í˜• AI, ì œì¡°ì—… ê³µì • íš¨ìœ¨ 30% ê°œì„  ì‚¬ë¡€
                        </h4>
                      </div>
                      <p
                        class="text-xs text-slate-600 leading-relaxed line-clamp-2"
                      >
                        ìŠ¤ë§ˆíŠ¸ íŒ©í† ë¦¬ ë„ì… ê¸°ì—…ë“¤ì˜ ë°ì´í„° ë¶„ì„ ì‹œê°„ì´
                        íšê¸°ì ìœ¼ë¡œ ë‹¨ì¶•ë˜ì—ˆìŠµë‹ˆë‹¤. ë„ì… ê²€í† ê°€ ì‹œê¸‰í•©ë‹ˆë‹¤.
                      </p>
                    </div>
                    <div
                      class="p-3 bg-slate-50 rounded-lg border border-slate-100 hover:bg-slate-100 transition-colors"
                    >
                      <div class="flex items-center mb-1">
                        <span
                          class="text-[10px] font-bold bg-white border border-slate-200 px-1.5 py-0.5 rounded text-sub mr-2"
                          >ê·œì œ/ì •ì±…</span
                        >
                        <h4 class="text-sm font-bold text-slate-800 truncate">
                          ESG ê³µì‹œ ì˜ë¬´í™”, ê³µê¸‰ë§ ê´€ë¦¬ ë¹„ìƒ
                        </h4>
                      </div>
                      <p
                        class="text-xs text-slate-600 leading-relaxed line-clamp-2"
                      >
                        í˜‘ë ¥ì‚¬ íƒ„ì†Œ ë°°ì¶œëŸ‰ ë°ì´í„° í™•ë³´ê°€ í•„ìˆ˜ ê³¼ì œë¡œ
                        ë– ì˜¬ëìŠµë‹ˆë‹¤. êµ¬ë§¤íŒ€ê³¼ ì—°ê³„í•œ ëŒ€ì‘ ì „ëµì´ í•„ìš”í•©ë‹ˆë‹¤.
                      </p>
                    </div>
                  </div>

                  <!-- Keywords & Chart Placeholder -->
                  <div class="flex flex-col">
                    <div class="mb-4">
                      <h4
                        class="text-xs font-bold text-sub mb-2 flex items-center"
                      >
                        <i
                          data-lucide="trending-up"
                          width="14"
                          class="mr-1"
                        ></i>
                        ì‹¤ì‹œê°„ íŠ¸ë Œë“œ í‚¤ì›Œë“œ
                      </h4>
                      <div class="flex flex-wrap gap-2">
                        <span
                          class="px-3 py-1 bg-main/5 text-main text-xs rounded-full font-medium hover:bg-main/10 cursor-pointer"
                          >#ì „ê³ ì²´ë°°í„°ë¦¬</span
                        >
                        <span
                          class="px-3 py-1 bg-main/5 text-main text-xs rounded-full font-medium hover:bg-main/10 cursor-pointer"
                          >#DXê°€ì†í™”</span
                        >
                        <span
                          class="px-3 py-1 bg-main/5 text-main text-xs rounded-full font-medium hover:bg-main/10 cursor-pointer"
                          >#íƒ„ì†Œêµ­ê²½ì„¸</span
                        >
                        <span
                          class="px-3 py-1 bg-main/5 text-main text-xs rounded-full font-medium hover:bg-main/10 cursor-pointer"
                          >#ì• ìì¼ì¡°ì§</span
                        >
                        <span
                          class="px-3 py-1 bg-main/5 text-main text-xs rounded-full font-medium hover:bg-main/10 cursor-pointer"
                          >#ìƒì„±í˜•AI</span
                        >
                      </div>
                    </div>
                    <div
                      class="flex-1 bg-slate-50 rounded-lg border border-slate-100 flex items-center justify-center p-4"
                    >
                      <div class="text-center">
                        <i
                          data-lucide="bar-chart-3"
                          width="24"
                          class="mx-auto text-slate-300 mb-2"
                        ></i>
                        <p class="text-xs text-slate-400">
                          í‚¤ì›Œë“œ ì–¸ê¸‰ëŸ‰ ë¶„ì„ ì°¨íŠ¸<br />(ë°ì´í„° ìˆ˜ì§‘ ì¤‘...)
                        </p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Document Summarizer -->
              <div class="lg:col-span-2 space-y-6">
                <div
                  class="bg-white rounded-xl shadow-sm border border-slate-100 p-6"
                >
                  <h3
                    class="font-semibold text-slate-700 mb-4 flex items-center justify-between"
                  >
                    <div class="flex items-center">
                      <i
                        data-lucide="file-text"
                        width="18"
                        class="mr-2 text-indigo-500"
                      ></i>
                      ë¬¸ì„œ/ë©”ì¼ AI ìš”ì•½
                    </div>
                    <span
                      class="text-xs bg-indigo-100 text-indigo-700 px-2 py-1 rounded"
                      >2ê±´ ì²˜ë¦¬ ì™„ë£Œ</span
                    >
                  </h3>
                  <div class="space-y-4">
                    <div class="border border-slate-200 rounded-lg p-4">
                      <div class="flex justify-between items-start mb-2">
                        <div class="flex items-center space-x-2">
                          <span class="font-bold text-slate-800"
                            >Q3 ì‹œì¥ ë™í–¥ ë¶„ì„ ë³´ê³ ì„œ</span
                          >
                          <span class="text-xs text-sub">(24 pages)</span>
                        </div>
                        <button class="text-xs text-sub underline">
                          ì›ë³¸ ë³´ê¸°
                        </button>
                      </div>
                      <div
                        class="bg-slate-50 p-3 rounded text-sm text-slate-700 leading-relaxed"
                      >
                        <span
                          class="inline-block bg-indigo-500 text-white text-[10px] px-1.5 py-0.5 rounded mr-2 align-middle"
                          >AI ìš”ì•½</span
                        >
                        ê²½ìŸì‚¬ Aì˜ ì ìœ ìœ¨ì´ 5% ìƒìŠ¹í•¨ì— ë”°ë¼ ëª¨ë°”ì¼ íƒ€ê²Ÿ ë§ˆì¼€íŒ…
                        ê°•í™” í•„ìš”. R&D ì˜ˆì‚° 10% ì¦ì•¡ ì œì•ˆ.
                      </div>
                    </div>
                    <div class="border border-slate-200 rounded-lg p-4">
                      <div class="flex justify-between items-start mb-2">
                        <div class="flex items-center space-x-2">
                          <span class="font-bold text-slate-800"
                            >ì„œë²„ ì¥ì•  ëŒ€ì‘ ë©”ë‰´ì–¼</span
                          >
                          <span class="text-xs text-sub">(15 pages)</span>
                        </div>
                        <button class="text-xs text-sub underline">
                          ì›ë³¸ ë³´ê¸°
                        </button>
                      </div>
                      <div
                        class="bg-slate-50 p-3 rounded text-sm text-slate-700 leading-relaxed"
                      >
                        <span
                          class="inline-block bg-indigo-500 text-white text-[10px] px-1.5 py-0.5 rounded mr-2 align-middle"
                          >AI ìš”ì•½</span
                        >
                        ì¥ì•  ë°œìƒ ì‹œ L1 ëŒ€ì‘íŒ€ 15ë¶„ ë‚´ ì†Œì§‘, L2 ì—ìŠ¤ì»¬ë ˆì´ì…˜
                        ê¸°ì¤€ êµ¬ì²´í™” í•„ìš”.
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div
                class="bg-white rounded-xl shadow-sm border border-slate-100 p-6 h-fit"
              >
                <h3 class="font-semibold text-slate-700 mb-4 flex items-center">
                  <i
                    data-lucide="calendar"
                    width="18"
                    class="mr-2 text-orange-500"
                  ></i>
                  ìŠ¤ë§ˆíŠ¸ ì¼ì • ê´€ë¦¬
                </h3>

                <div class="mb-6">
                  <div class="flex items-center justify-between mb-2">
                    <span class="text-sm font-medium text-slate-600"
                      >ì˜¤ëŠ˜ì˜ ì¼ì • ì¶©ëŒ ê°ì§€</span
                    >
                    <span
                      class="text-xs bg-red-100 text-red-600 px-2 py-0.5 rounded-full font-bold"
                      >1ê±´</span
                    >
                  </div>
                  <div
                    class="p-3 border-l-4 border-red-400 bg-red-50 rounded-r-lg"
                  >
                    <p class="text-sm font-bold text-slate-800">
                      14:00 íŒ€ ì£¼ê°„íšŒì˜
                    </p>
                    <p class="text-sm text-sub">vs ê²½ì˜ì§„ ê¸´ê¸‰ ë³´ê³ </p>
                    <div
                      class="mt-3 bg-white p-2 rounded border border-red-100"
                    >
                      <p class="text-xs text-slate-500 mb-1">
                        ğŸ¤– AI ì¡°ìœ¨ì•ˆ ì¶”ì²œ
                      </p>
                      <p class="text-xs text-slate-800 font-medium">
                        íŒ€ ì£¼ê°„íšŒì˜ë¥¼ ë‚´ì¼ ì˜¤ì „ 10ì‹œë¡œ ë³€ê²½í•˜ê³ , ë©”ì¼ë¡œ ì‚¬ì „
                        ê³µì§€ ë°œì†¡.
                      </p>
                      <button
                        class="mt-2 w-full bg-red-500 text-white text-xs py-1.5 rounded hover:bg-red-600"
                      >
                        ì´ëŒ€ë¡œ ì¡°ìœ¨í•˜ê¸°
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- 5. Students (ì—‘ì…€ ì…ë ¥/ì—…ë¡œë“œ) View -->
          <div
            id="view-students"
            class="hidden fade-in h-full flex flex-col space-y-6"
          >
            <header>
              <h2 class="text-2xl font-bold text-slate-800 mb-1">
                í•™ìƒ ê´€ë¦¬ Â· ì—‘ì…€ ì…ë ¥/ì—…ë¡œë“œ
              </h2>
              <p class="text-sub">
                í•™ìƒ ì •ë³´ë¥¼ ì—‘ì…€ë¡œ ì—…ë¡œë“œí•˜ê±°ë‚˜, ë³µì‚¬-ë¶™ì—¬ë„£ê¸°, ê°œë³„ ì…ë ¥ìœ¼ë¡œ
                ì¶”ê°€í•œ ë’¤, ë‹¤ì‹œ Excel/CSVë¡œ ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
              </p>
            </header>

            <div class="student-layout">
              <!-- ì™¼ìª½: ì…ë ¥/ì—…ë¡œë“œ ì˜ì—­ -->
              <div class="card form-card">
                <h1>í•™ìƒ ì •ë³´ ì…ë ¥ ì—°ìŠµ (ì—‘ì…€ ì—…ë¡œë“œ/ë¶™ì—¬ë„£ê¸°)</h1>
                <p class="subtitle">
                  âœ… <strong>ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ</strong> ë˜ëŠ”
                  <strong>ì—‘ì…€ì—ì„œ ë³µì‚¬â†’ë¶™ì—¬ë„£ê¸°</strong> í›„ ì˜¤ë¥¸ìª½ ë¦¬ìŠ¤íŠ¸ì—
                  ìë™ ì¶”ê°€ë©ë‹ˆë‹¤.<br />
                  ğŸ”¹ ì—‘ì…€ ì–‘ì‹ì€ <code>í•™ìƒ ì´ë¦„ (í•„ìˆ˜)</code>,
                  <code>ë¶€ëª¨ë‹˜ ì „í™”ë²ˆí˜¸ (í•„ìˆ˜).</code> â€¦ ì›ë³¸ í—¤ë”ë¥¼ ê·¸ëŒ€ë¡œ ì¨ë„
                  ë˜ê³ ,<br />
                  ğŸ”¹ ê°„ë‹¨íˆ
                  <code
                    >ì´ë¦„ / ë¶€ëª¨ / í•™ìƒí° / í•™êµ / í•™ë…„ / ê³„ì—´ / ì„±ë³„ /
                    ë¹„ë²ˆ</code
                  >
                  ê°™ì€ í•œêµ­ì–´ í—¤ë”ë¥¼ ì¨ë„ ì¸ì‹í•©ë‹ˆë‹¤.
                </p>

                <h2>ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ</h2>
                <div class="form-actions" style="margin-top: 4px">
                  <input
                    type="file"
                    id="excel-file-input"
                    accept=".xlsx,.xls,.csv"
                  />
                  <span class="status-text"
                    >[ëŒ€ì¹˜ì˜¨] í•™ìƒ ì¶”ê°€ìš© ì‹œíŠ¸.xlsx ê·¸ëŒ€ë¡œ ì˜¬ë ¤ë„
                    ì¸ì‹ë©ë‹ˆë‹¤.</span
                  >
                </div>

                <h2>ì—‘ì…€ ì¼ê´„ ì…ë ¥ (ë³µì‚¬ ë¶™ì—¬ë„£ê¸°)</h2>
                <textarea
                  id="excel-bulk-input-area"
                  placeholder="ì˜ˆì‹œ:
ê¹€í•™ìƒ	010-1111-1111	010-2222-2222	ì„œê°•ê³ 	ê³ 1	ì´ê³¼	ë‚¨	abcd
ì´í•™ìƒ	010-3333-3333	010-4444-4444	ê´‘ì„±ê³ 	ê³ 2	ë¬¸ê³¼	ì—¬	qwer
"
                ></textarea>
                <div class="form-actions" style="margin-top: 8px">
                  <button id="add-bulk-button" class="secondary-btn">
                    â¬‡ï¸ ë¶™ì—¬ë„£ì€ ë‚´ìš© ì „ì²´ ì¶”ê°€
                  </button>
                </div>

                <h2>ê°œë³„ ì…ë ¥</h2>
                <div class="form-grid">
                  <div class="form-field">
                    <label for="student-name-input">ì´ë¦„ (í•„ìˆ˜)</label>
                    <input
                      type="text"
                      id="student-name-input"
                      placeholder="ì˜ˆ: ê¹€í•™ìƒ"
                    />
                  </div>
                  <div class="form-field">
                    <label for="parent-phone-input">ë¶€ëª¨ë‹˜ ì „í™” (í•„ìˆ˜)</label>
                    <input
                      type="tel"
                      id="parent-phone-input"
                      placeholder="010-0000-0000"
                    />
                  </div>
                  <div class="form-field">
                    <label for="student-phone-input">í•™ìƒ ì „í™”</label>
                    <input
                      type="tel"
                      id="student-phone-input"
                      placeholder="010-0000-0000"
                    />
                  </div>
                  <div class="form-field">
                    <label for="password-input">ë¹„ë°€ë²ˆí˜¸ (í•„ìˆ˜)</label>
                    <input
                      type="password"
                      id="password-input"
                      placeholder="ì˜ˆ: abcd"
                    />
                  </div>
                  <div class="form-field">
                    <label for="highschool-name-input">í•™êµ</label>
                    <input
                      type="text"
                      id="highschool-name-input"
                      placeholder="ì˜ˆ: ì„œê°•ê³ "
                    />
                  </div>
                  <div class="form-field">
                    <label for="grade-select">í•™ë…„</label>
                    <select id="grade-select">
                      <option value="">ì„ íƒ ì•ˆ í•¨</option>
                      <option value="ì¤‘1">ì¤‘1</option>
                      <option value="ì¤‘2">ì¤‘2</option>
                      <option value="ì¤‘3">ì¤‘3</option>
                      <option value="ê³ 1">ê³ 1</option>
                      <option value="ê³ 2">ê³ 2</option>
                      <option value="ê³ 3">ê³ 3</option>
                    </select>
                  </div>
                  <div class="form-field">
                    <label for="track-select">ê³„ì—´</label>
                    <select id="track-select">
                      <option value="">ì„ íƒ ì•ˆ í•¨</option>
                      <option value="ì´ê³¼">ì´ê³¼</option>
                      <option value="ë¬¸ê³¼">ë¬¸ê³¼</option>
                      <option value="í†µí•©">í†µí•©</option>
                    </select>
                  </div>
                  <div class="form-field">
                    <label for="gender-select">ì„±ë³„</label>
                    <select id="gender-select">
                      <option value="">ì„ íƒ ì•ˆ í•¨</option>
                      <option value="ë‚¨">ë‚¨</option>
                      <option value="ì—¬">ì—¬</option>
                    </select>
                  </div>
                </div>

                <div class="form-actions">
                  <button id="add-student-button">â• ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€</button>
                  <button
                    type="button"
                    class="secondary-btn"
                    id="clear-fields-button"
                  >
                    ğŸ§¹ ì…ë ¥ê°’ ì´ˆê¸°í™”
                  </button>
                  <span class="status-text" id="status-text"
                    >ì•„ì§ ì¶”ê°€ëœ í•™ìƒì´ ì—†ìŠµë‹ˆë‹¤.</span
                  >
                </div>
              </div>

              <!-- ì˜¤ë¥¸ìª½: í•™ìƒ ë¦¬ìŠ¤íŠ¸ / ë‹¤ìš´ë¡œë“œ -->
              <div class="card student-list-panel">
                <div class="student-list-header">
                  <span class="student-list-title">í•™ìƒ ë¦¬ìŠ¤íŠ¸</span>
                  <span class="student-count-badge" id="student-count-badge"
                    >0ëª…</span
                  >
                  <span style="display: flex; gap: 5px">
                    <button
                      id="download-xlsx-btn"
                      class="secondary-btn"
                      style="padding: 5px 10px"
                    >
                      ğŸ“¥ Excel
                    </button>
                    <button
                      id="download-csv-btn"
                      class="secondary-btn"
                      style="padding: 5px 10px"
                    >
                      ğŸ“¥ CSV
                    </button>
                  </span>
                </div>
                <div class="student-table-container">
                  <table>
                    <thead>
                      <tr>
                        <th>ì´ë¦„</th>
                        <th>ë¶€ëª¨</th>
                        <th>í•™ìƒí°</th>
                        <th>í•™êµ/í•™ë…„</th>
                        <th>ê³„ì—´</th>
                        <th>ì„±ë³„</th>
                        <th>ë¹„ë²ˆ</th>
                      </tr>
                    </thead>
                    <tbody id="student-list-body">
                      <!-- JSë¡œ í–‰ì´ ì¶”ê°€ë¨ -->
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <!-- JavaScript Logic -->
    <script>
      // --- Data ---
      const teamMembers = [
        {
          id: 1,
          name: "ë°•ì¬í˜„",
          role: "ìš°ë¦¬ì¡° ë¶„ìœ„ê¸° ë©”ì´ì»¤",
          effort: 92,
          result: 85,
          difficulty: "ìƒ",
          recent: "íŒ€ í™œë ¥ ì¦ì§„ ì´ë²¤íŠ¸ ê¸°íš",
          detailedTasks: [
            {
              date: "10/20",
              task: "íŒ€ í• ë¡œìœˆ íŒŒí‹° ê¸°íšì•ˆ ì œì¶œ",
              status: "ì™„ë£Œ",
            },
            { date: "10/22", task: "ì›Œí¬ìƒµ ì¥ì†Œ ì‚¬ì „ ë‹µì‚¬", status: "ì§„í–‰ì¤‘" },
            { date: "10/24", task: "ë¶„ê¸°ë³„ íŒ€ì› ì¸í„°ë·° ì •ë¦¬", status: "ëŒ€ê¸°" },
          ],
        },
        {
          id: 2,
          name: "ë°•íƒœí¬",
          role: "ë©‹ì§„ íŒ€ì¥ë‹˜",
          effort: 98,
          result: 99,
          difficulty: "ìµœìƒ",
          recent: "ì „ì‚¬ ë¹„ì „ ìˆ˜ë¦½ ë° ì „íŒŒ",
          detailedTasks: [
            {
              date: "10/18",
              task: "2024 ì „ì‚¬ ë¹„ì „ ë°œí‘œ PT ì¤€ë¹„",
              status: "ì™„ë£Œ",
            },
            { date: "10/23", task: "ë¶€ì„œì¥ íšŒì˜ ì•ˆê±´ ë°œì˜", status: "ì™„ë£Œ" },
            {
              date: "10/25",
              task: "íŒ€ ë¦¬ì†ŒìŠ¤ ë°°ë¶„ ê³„íš ìˆ˜ì •",
              status: "ì§„í–‰ì¤‘",
            },
          ],
        },
        {
          id: 3,
          name: "ë°•ì •í˜¸",
          role: "ìš°ë¦¬ì¡° ìƒ¤í¬",
          effort: 88,
          result: 80,
          difficulty: "ìƒ",
          recent: "ê³µê²©ì  ì‹œì¥ ì§„ì… ì „ëµ ìˆ˜ë¦½",
          detailedTasks: [
            {
              date: "10/21",
              task: "ê²½ìŸì‚¬ Cì‚¬ ê°€ê²© ì •ì±… ë¶„ì„",
              status: "ì™„ë£Œ",
            },
            {
              date: "10/22",
              task: "ì‹ ê·œ ë§ˆì¼“ ì§„ì… ì‹œë‚˜ë¦¬ì˜¤ ê¸°íš",
              status: "ì§„í–‰ì¤‘",
            },
            { date: "10/24", task: "ì˜ì—…íŒ€ ì „ëµ ê³µìœ  ë¯¸íŒ…", status: "ì˜ˆì •" },
          ],
        },
        {
          id: 4,
          name: "í•˜ìœ ë¦¼",
          role: "ìŠˆí¼ í¬ë™",
          effort: 95,
          result: 96,
          difficulty: "ìƒ",
          recent: "í•µì‹¬ ë‚œì œ í•´ê²° ë° ì„±ê³¼ ê²¬ì¸",
          detailedTasks: [
            {
              date: "10/19",
              task: "ë ˆê±°ì‹œ ì‹œìŠ¤í…œ ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜",
              status: "ì™„ë£Œ",
            },
            {
              date: "10/21",
              task: "ê²°ì œ ëª¨ë“ˆ ì„±ëŠ¥ ì´ìŠˆ í•«í”½ìŠ¤",
              status: "ì™„ë£Œ",
            },
            { date: "10/23", task: "ì‹ ê·œ API ë¬¸ì„œí™” ì‘ì—…", status: "ì§„í–‰ì¤‘" },
          ],
        },
      ];

      const careTips = [
        {
          icon: "coffee",
          color: "text-amber-600",
          bg: "bg-amber-50",
          title: "ë”°ëœ»í•œ ì°¨ í•œ ì”ì˜ ì—¬ìœ ",
          content:
            "ê³„ì†ë˜ëŠ” íšŒì˜ë¡œ ëª©ì´ íƒ€ì‹œì£ ? â˜•ï¸ ì§€ê¸ˆ ì ê¹ 5ë¶„ë§Œ ì‹œê°„ì„ ë‚´ì–´ ë”°ëœ»í•œ ìºëª¨ë§ˆì¼ í‹°ë¥¼ ë§ˆì…”ë³´ì„¸ìš”. ê¸´ì¥ ì™„í™”ì— ë„ì›€ì´ ë©ë‹ˆë‹¤.",
        },
        {
          icon: "sun",
          color: "text-orange-500",
          bg: "bg-orange-50",
          title: "ê´‘í•©ì„± íƒ€ì„",
          content:
            "ì‹¤ë‚´ì—ë§Œ ê³„ì‹ ê°€ìš”? â˜€ï¸ ì°½ë¬¸ì„ ì—´ê±°ë‚˜ ì ì‹œ ì˜¥ìƒì— ì˜¬ë¼ê°€ í–‡ë³•ì„ ì¬ì–´ë³´ì„¸ìš”. ë¹„íƒ€ë¯¼DëŠ” ë¦¬ë”ì˜ ìš°ìš¸ê°ì„ ì—†ì• ì£¼ëŠ” íŠ¹íš¨ì•½ì…ë‹ˆë‹¤!",
        },
        {
          icon: "music",
          color: "text-purple-500",
          bg: "bg-purple-50",
          title: "í™”ì´íŠ¸ ë…¸ì´ì¦ˆ & ëª…ìƒ",
          content:
            'ë¨¸ë¦¬ê°€ ë³µì¡í•  ë• ëˆˆì„ ê°ê³  3ë¶„ë§Œ ì‹¬í˜¸í¡ í•´ë³´ì„¸ìš”. ğŸ§ ë¹—ì†Œë¦¬ë‚˜ íŒŒë„ ì†Œë¦¬ë¥¼ ë“¤ìœ¼ë©° ë‡Œë¥¼ ì ì‹œ "ì˜¤í”„(Off)" ì‹œí‚¤ëŠ” ê²ƒë„ ì „ëµì…ë‹ˆë‹¤.',
        },
        {
          icon: "smile",
          color: "text-pink-500",
          bg: "bg-pink-50",
          title: "ê±°ìš¸ ë³´ê³  ìŠ¤ë§ˆì¼",
          content:
            "ë¦¬ë”ì˜ í‘œì •ì€ íŒ€ì˜ ë‚ ì”¨ì…ë‹ˆë‹¤. ğŸ˜Š ê±°ìš¸ì„ ë³´ê³  ì–µì§€ë¡œë¼ë„ í•œë²ˆ ì›ƒì–´ë³´ì„¸ìš”. ë‡Œê°€ ì¦ê±°ìš´ ì¼ì´ ìˆë‹¤ê³  ì°©ê°í•´ ì—”ëŒí•€ì„ ì„ ë¬¼í•  ê±°ì˜ˆìš”.",
        },
      ];

      let selectedMemberId = 1;
      let currentFeedbackTarget = "í•˜ìœ ë¦¼";

      // --- Functions ---

      function getPuppySVG(emotion = "happy", size = 40) {
        const fontSize = Math.max(20, size * 0.8);
        let emoji = "ğŸ¶";
        if (emotion === "sleepy") {
          emoji = "ğŸ¶";
        }
        return `<div style="font-size: ${fontSize}px; line-height: 1; display: flex; justify-content: center; align-items: center; cursor: default;">${emoji}</div>`;
      }

      function switchTab(tabName) {
        ["dashboard", "fairness", "relationship", "time", "students"].forEach(
          (t) => {
            const view = document.getElementById(`view-${t}`);
            if (view) {
              view.classList.add("hidden");
            }
          }
        );
        const currentView = document.getElementById(`view-${tabName}`);
        if (currentView) {
          currentView.classList.remove("hidden");
        }

        const buttons = document.querySelectorAll(".sidebar-item");
        buttons.forEach((btn) => {
          if (btn.textContent.trim().includes(translateTab(tabName))) {
            btn.classList.add("active", "text-main");
            btn.classList.remove("text-white/80");
          } else {
            btn.classList.remove("active", "text-main");
            btn.classList.add("text-white/80");
          }
        });
        lucide.createIcons();
      }

      function translateTab(eng) {
        const map = {
          dashboard: "ëŒ€ì‹œë³´ë“œ",
          fairness: "ê³µì •ì„±",
          relationship: "ê´€ê³„",
          time: "ì‹œê°„",
          students: "í•™ìƒ ê´€ë¦¬",
        };
        return map[eng] || "";
      }

      function renderFairness() {
        const listContainer = document.getElementById("team-list-container");
        listContainer.innerHTML = teamMembers
          .map(
            (m) => `
                <button onclick="selectMember(${
                  m.id
                })" class="w-full flex items-center justify-between p-3 rounded-lg transition-all ${
              m.id === selectedMemberId
                ? "bg-main/5 border border-main/20 ring-1 ring-main/20"
                : "hover:bg-slate-50 border border-transparent"
            }">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 rounded-full bg-slate-200 flex items-center justify-center text-slate-600 font-bold">
                            ${m.name[0]}
                        </div>
                        <div class="text-left">
                            <div class="font-medium text-slate-800">${
                              m.name
                            }</div>
                            <div class="text-xs text-sub">${m.role}</div>
                        </div>
                    </div>
                    <i data-lucide="chevron-right" width="16" class="text-sub"></i>
                </button>
            `
          )
          .join("");

        const member = teamMembers.find((m) => m.id === selectedMemberId);
        const detailContainer = document.getElementById("fairness-detail");

        const insight =
          member.effort > member.result
            ? `${member.name}ë‹˜ì€ ë†’ì€ ë…¸ë ¥(Process)ì„ ê¸°ìš¸ì˜€ìœ¼ë‚˜, ì™¸ë¶€ ìš”ì¸ìœ¼ë¡œ ì¸í•´ ê²°ê³¼(Result) ì§€í‘œê°€ ë‹¤ì†Œ ë‚®ìŠµë‹ˆë‹¤. í‰ê°€ ë©´ë‹´ ì‹œ ì´ ë¶€ë¶„ì„ ì¶©ë¶„íˆ ì°¸ì‘í–ˆë‹¤ëŠ” ì ì„ ì–¸ê¸‰í•˜ì—¬ ì–µìš¸í•¨ì„ í•´ì†Œí•´ ì£¼ì„¸ìš”. ë©!`
            : `${member.name}ë‹˜ì€ íš¨ìœ¨ì ìœ¼ë¡œ ì„±ê³¼ë¥¼ ëƒˆìŠµë‹ˆë‹¤. ë‹¤ë§Œ íŒ€ ë‚´ ê¸°ì—¬ë„ ì¸¡ë©´ì—ì„œ ë™ë£Œë“¤ê³¼ì˜ í˜‘ì—… ë¹ˆë„ë¥¼ ë†’ì´ë„ë¡ ì½”ì¹­í•˜ë©´ ë” ì¢‹ì€ ë¦¬ë”ë¡œ ì„±ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë©!`;

        const detailedTasksHtml = member.detailedTasks
          .map(
            (task) => `
                <div class="flex items-center justify-between p-3 bg-white border border-slate-100 rounded-lg mb-2">
                    <div class="flex items-center space-x-3">
                        <span class="text-xs font-mono text-sub bg-slate-100 px-2 py-1 rounded">${
                          task.date
                        }</span>
                        <span class="text-sm text-slate-700">${task.task}</span>
                    </div>
                    <span class="text-xs font-bold ${
                      task.status === "ì™„ë£Œ"
                        ? "text-green-600"
                        : task.status === "ì§„í–‰ì¤‘"
                        ? "text-blue-600"
                        : "text-slate-400"
                    }">
                        ${task.status}
                    </span>
                </div>
            `
          )
          .join("");

        detailContainer.innerHTML = `
                <div class="flex justify-between items-start mb-6">
                    <div>
                        <h3 class="text-xl font-bold text-slate-800">${
                          member.name
                        } <span class="text-base font-normal text-sub">ë‹˜ì˜ ì„±ê³¼ ë¶„ì„</span></h3>
                        <span class="inline-block mt-1 px-2 py-0.5 bg-indigo-100 text-indigo-700 text-xs rounded-full font-medium">ìµœê·¼ ì—…ë¬´: ${
                          member.recent
                        }</span>
                    </div>
                    <div class="text-right">
                        <div class="text-sm text-sub">AI ë‚œì´ë„ ë³´ì •</div>
                        <div class="text-lg font-bold text-main">${
                          member.difficulty
                        } (High)</div>
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-6 mb-6">
                    <div class="bg-slate-50 p-4 rounded-lg">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-sm font-medium text-slate-600">ê¸°ì—¬ë„ (Effort)</span>
                            <span class="text-lg font-bold text-slate-800">${
                              member.effort
                            }ì </span>
                        </div>
                        <div class="w-full bg-slate-200 rounded-full h-2.5">
                            <div class="bg-main h-2.5 rounded-full" style="width: ${
                              member.effort
                            }%"></div>
                        </div>
                    </div>
                    <div class="bg-slate-50 p-4 rounded-lg">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-sm font-medium text-slate-600">ê²°ê³¼ (Result)</span>
                            <span class="text-lg font-bold text-slate-800">${
                              member.result
                            }ì </span>
                        </div>
                        <div class="w-full bg-slate-200 rounded-full h-2.5">
                            <div class="bg-green-500 h-2.5 rounded-full" style="width: ${
                              member.result
                            }%"></div>
                        </div>
                    </div>
                </div>
                <div class="mb-6 bg-slate-50 p-4 rounded-lg">
                    <h4 class="text-sm font-bold text-slate-700 mb-3 flex items-center">
                        <i data-lucide="list-checks" width="16" class="mr-2"></i>ìµœê·¼ ì£¼ìš” ì—…ë¬´ íˆìŠ¤í† ë¦¬
                    </h4>
                    ${detailedTasksHtml}
                </div>
                <div class="bg-main/5 rounded-lg p-5 border border-main/20 mt-auto">
                    <div class="flex items-start space-x-3">
                        <div class="mt-1">${getPuppySVG("smart", 32)}</div>
                        <div>
                            <h4 class="font-bold text-main mb-1">ì¼€ë°€ë¦¬ì˜ ì½”ì¹­ ë…¸íŠ¸ ğŸ¶</h4>
                            <p class="text-sm text-main leading-relaxed">${insight}</p>
                        </div>
                    </div>
                </div>
            `;
        lucide.createIcons();
      }

      function selectMember(id) {
        selectedMemberId = id;
        renderFairness();
      }

      function generateMessage(tone) {
        const area = document.getElementById("message-area");
        const input = document.getElementById("message-input");

        if (input) {
          input.value = "";
        }

        area.innerHTML = `
                <div class="absolute inset-0 flex items-center justify-center flex-col">
                    <div class="w-6 h-6 border-2 border-main border-t-transparent rounded-full animate-spin mb-2"></div>
                    <span class="text-xs text-main">ì¼€ë°€ë¦¬ê°€ ê³ ë¯¼ì¤‘ì…ë‹ˆë‹¤... ğŸ¶</span>
                </div>
            `;

        setTimeout(() => {
          let text = "";
          const target = currentFeedbackTarget;

          if (target === "í•˜ìœ ë¦¼") {
            if (tone === "formal")
              text =
                "ìœ ë¦¼ë‹˜, í•­ìƒ ê¹Šì´ ìˆëŠ” ë¦¬ì„œì¹˜ì™€ íƒì›”í•œ ê²°ê³¼ë¬¼ì„ ê³µìœ í•´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤. ìœ ë¦¼ë‹˜ì˜ í›Œë¥­í•œ ë¦¬ì„œì¹˜ í€„ë¦¬í‹° ë•ë¶„ì— íŒ€ ì „ì²´ê°€ ìƒˆë¡œìš´ ì¸ì‚¬ì´íŠ¸ë¥¼ ì–»ê³  ìˆìŠµë‹ˆë‹¤. ì•ìœ¼ë¡œë„ ì¢‹ì€ í™œì•½ ê¸°ëŒ€í•©ë‹ˆë‹¤.";
            else if (tone === "friendly")
              text =
                "ìœ ë¦¼ë‹˜! ì´ë²ˆì— ê³µìœ í•´ì£¼ì‹  ë¦¬ì„œì¹˜ ìë£Œ ì§„ì§œ ëŒ€ë°•ì´ì—ìš” ğŸ‘ ë³´ë©´ì„œ ê³„ì† ê°íƒ„í–ˆì–´ìš”. ì €ë„ ìœ ë¦¼ë‹˜ ë•ë¶„ì— ë§ì´ ë°°ìš°ê³  ê°‘ë‹ˆë‹¤! í•­ìƒ ê³ ë§ˆì›Œìš” â˜•ï¸";
            else
              text =
                "ìœ ë¦¼ë‹˜, ë§¤ë²ˆ ê¸°ëŒ€ ì´ìƒì˜ ë¦¬ì„œì¹˜ í€„ë¦¬í‹°ë¥¼ ë³´ì—¬ì£¼ì‹œëŠ” ì—´ì •ì— ë°•ìˆ˜ë¥¼ ë³´ëƒ…ë‹ˆë‹¤! ìœ ë¦¼ë‹˜ì˜ ì „ë¬¸ì„±ì´ ìš°ë¦¬ íŒ€ì˜ ê²½ìŸë ¥ì„ ë†’ì´ê³  ìˆìŠµë‹ˆë‹¤. ìµœê³ ì˜ˆìš”!";
          } else if (target === "ë°•ì¬í˜„") {
            if (tone === "formal")
              text =
                "ì¬í˜„ë‹˜, ì–¸ì œë‚˜ íšŒì˜ ë¶„ìœ„ê¸°ë¥¼ ê¸ì •ì ìœ¼ë¡œ ì´ëŒì–´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤. ì¬í˜„ë‹˜ ë•ë¶„ì— íŒ€ ë‚´ ì†Œí†µì´ ì›í™œí•´ì§€ê³ , ì—…ë¬´ íš¨ìœ¨ë„ ë†’ì•„ì§€ê³  ìˆìŠµë‹ˆë‹¤.";
            else if (tone === "friendly")
              text =
                "ì¬í˜„ë‹˜ ã…‹ã…‹ ëª…ì‹¤ìƒë¶€ ìš°ë¦¬ ì¡° ë¶„ìœ„ê¸° ë©”ì´ì»¤ ì¸ì •! ğŸ˜† íšŒì˜ ë•Œë§ˆë‹¤ ì¬í˜„ë‹˜ ë•ë¶„ì— ë¹µ í„°ì ¸ì„œ í–‰ë³µí•˜ê²Œ ì¼í•˜ê³  ìˆì–´ìš”. ìš°ë¦¬ íŒ€ì˜ ë¹„íƒ€ë¯¼ ê°™ì€ ì¡´ì¬!";
            else
              text =
                "ì¬í˜„ë‹˜, ì§€ì¹  ìˆ˜ ìˆëŠ” ìƒí™©ì—ì„œë„ ì›ƒìŒì„ ìƒì§€ ì•Šê³  íŒ€ì— í™œë ¥ì„ ë¶ˆì–´ë„£ì–´ ì£¼ì…”ì„œ ì •ë§ ë“ ë“ í•©ë‹ˆë‹¤. ì¬í˜„ë‹˜ì˜ ë°ì€ ì—ë„ˆì§€ê°€ ìš°ë¦¬ íŒ€ì˜ ê°€ì¥ í° ë¬´ê¸°ì…ë‹ˆë‹¤!";
          } else if (target === "ë°•íƒœí¬") {
            if (tone === "formal")
              text =
                "íƒœí¬ íŒ€ì¥ë‹˜, íƒì›”í•œ ë¦¬ë”ì‹­ìœ¼ë¡œ íŒ€ì„ ì„±ê³µì ìœ¼ë¡œ ì´ëŒì–´ ì£¼ì…”ì„œ ê¹Šì´ ê°ì‚¬ë“œë¦½ë‹ˆë‹¤. íŒ€ì¥ë‹˜ì˜ ë°©í–¥ì„± ë•ë¶„ì— ëª¨ë‘ê°€ ì—…ë¬´ì— í™•ì‹ ì„ ê°–ê³  ì„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.";
            else if (tone === "friendly")
              text =
                "íƒœí¬ë‹˜! í•­ìƒ ë©‹ì§€ê²Œ ë¦¬ë”©í•´ì£¼ì…”ì„œ ë„ˆë¬´ ê°ì‚¬í•´ìš”. íƒœí¬ë‹˜ ë•ë¶„ì— ìš”ì¦˜ íŒ€ ë¶„ìœ„ê¸°ë„ ì¢‹ê³  ì¼í•˜ëŠ” ê²Œ ë„ˆë¬´ ì¬ë°Œì–´ìš”! ë¯¿ê³  ë”°ë¥´ê² ìŠµë‹ˆë‹¤ ğŸ‘";
            else
              text =
                "íƒœí¬ë‹˜, íŒ€ì›ë“¤ì„ ì•„ìš°ë¥´ëŠ” ë¦¬ë”ì‹­ê³¼ í—Œì‹ ì ì¸ ëª¨ìŠµì— í•­ìƒ ê°ë™í•˜ê³  ìˆìŠµë‹ˆë‹¤. íƒœí¬ë‹˜ê³¼ í•¨ê»˜ë¼ë©´ ì–´ë–¤ ëª©í‘œë“  ë‹¬ì„±í•  ìˆ˜ ìˆì„ ê²ƒ ê°™ì•„ìš”! í™”ì´íŒ…!";
          } else if (target === "ë°•ì •í˜¸") {
            if (tone === "formal")
              text =
                "ì •í˜¸ë‹˜, ì—…ë¬´ì—ì„œ ë³´ì—¬ì£¼ì‹œëŠ” ë¶„ì„ë ¥ê³¼ í†µì°°ë ¥ì— ë§¤ë²ˆ ë†€ë¼ê³  ìˆìŠµë‹ˆë‹¤. ì •í˜¸ë‹˜ì˜ ë‚ ì¹´ë¡œìš´ ì¸ì‚¬ì´íŠ¸ê°€ í”„ë¡œì íŠ¸ì˜ ì™„ì„±ë„ë¥¼ ë†’ì´ëŠ” ë° í° ì—­í• ì„ í•©ë‹ˆë‹¤.";
            else if (tone === "friendly")
              text =
                "ì •í˜¸ë‹˜, ì´ë²ˆ ë¶„ì„ ì§„ì§œ ì†Œë¦„... ğŸ˜² ì–´ë–»ê²Œ ê·¸ëŸ° ë¶€ë¶„ê¹Œì§€ ìºì¹˜í•˜ì…¨ì–´ìš”? ì •í˜¸ë‹˜ì˜ ì—„ì²­ë‚œ ì¸ì‚¬ì´íŠ¸, ì œê°€ ë§ì´ ë°°ìš°ê³  ìˆìŠµë‹ˆë‹¤! ë¦¬ìŠ¤í™!";
            else
              text =
                "ì •í˜¸ë‹˜, ë³µì¡í•œ ë¬¸ì œì˜ í•µì‹¬ì„ ê¿°ëš«ì–´ ë³´ëŠ” í†µì°°ë ¥ì€ ìš°ë¦¬ íŒ€ì˜ ëŒ€ì²´ ë¶ˆê°€í•œ ìì‚°ì…ë‹ˆë‹¤. ì •í˜¸ë‹˜ì˜ ëŠ¥ë ¥ì„ ë§ˆìŒê» í¼ì³ì£¼ì„¸ìš”. í•­ìƒ ì‘ì›í•©ë‹ˆë‹¤!";
          } else {
            text = `${target}ë‹˜, í•­ìƒ íŒ€ì„ ìœ„í•´ ë…¸ë ¥í•´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤.`;
          }

          area.innerHTML = `<textarea class="w-full h-full bg-transparent border-none resize-none focus:ring-0 text-slate-700 leading-relaxed outline-none" id="message-input">${text}</textarea>`;
        }, 800);
      }

      function setFeedbackTarget(name) {
        currentFeedbackTarget = name;
        document.getElementById(
          "generator-title"
        ).innerText = `AI ë©”ì‹œì§€ ìƒì„±ê¸° (${name}ë‹˜)`;

        const cards = [
          "alert-hayurim",
          "alert-parkjaehyun",
          "alert-parktaehee",
          "alert-parkjeongho",
        ];
        cards.forEach((id) => {
          const el = document.getElementById(id);
          if (el) {
            el.classList.remove(
              "ring-2",
              "ring-pink-200",
              "bg-pink-50",
              "ring-slate-300",
              "bg-slate-50",
              "bg-blue-50",
              "ring-blue-200",
              "bg-indigo-50",
              "ring-indigo-200"
            );
            el.classList.add("bg-white", "border-slate-200");

            if (id.includes("hayurim") && name === "í•˜ìœ ë¦¼") {
              el.classList.add("ring-2", "ring-pink-200", "bg-pink-50");
              el.classList.remove("bg-white", "border-slate-200");
            } else if (id.includes("parkjaehyun") && name === "ë°•ì¬í˜„") {
              el.classList.add("ring-2", "ring-slate-300", "bg-slate-50");
              el.classList.remove("bg-white", "border-slate-200");
            } else if (id.includes("parktaehee") && name === "ë°•íƒœí¬") {
              el.classList.add("ring-2", "ring-blue-200", "bg-blue-50");
              el.classList.remove("bg-white", "border-slate-200");
            } else if (id.includes("parkjeongho") && name === "ë°•ì •í˜¸") {
              el.classList.add("ring-2", "ring-indigo-200", "bg-indigo-50");
              el.classList.remove("bg-white", "border-slate-200");
            }
          }
        });

        document.getElementById(
          "message-area"
        ).innerHTML = `<textarea class="w-full h-full bg-transparent border-none resize-none focus:ring-0 text-slate-700 leading-relaxed outline-none" id="message-input">ìœ„ ë²„íŠ¼ì„ ëˆŒëŸ¬ AIì—ê²Œ ${name}ë‹˜ì„ ìœ„í•œ ì´ˆì•ˆ ì‘ì„±ì„ ìš”ì²­í•˜ì„¸ìš”.</textarea>`;
      }

      function renderCareTip(index) {
        const tip = careTips[index];
        const container = document.getElementById("care-content-area");

        let iconHtml = "";
        if (tip.icon === "coffee")
          iconHtml = '<i data-lucide="coffee" width="24"></i>';
        if (tip.icon === "sun")
          iconHtml = '<i data-lucide="sun" width="24"></i>';
        if (tip.icon === "music")
          iconHtml = '<i data-lucide="music" width="24"></i>';
        if (tip.icon === "smile")
          iconHtml = '<i data-lucide="smile" width="24"></i>';

        container.className = `flex items-start p-4 rounded-xl ${tip.bg} transition-all duration-300`;
        container.innerHTML = `
                <div class="p-3 rounded-full bg-white shadow-sm ${tip.color} mr-4">
                    ${iconHtml}
                </div>
                <div>
                    <h4 class="font-bold text-lg mb-1 ${tip.color}">${tip.title}</h4>
                    <p class="text-slate-700 leading-relaxed">${tip.content}</p>
                    <p class="text-xs text-sub mt-2">From. ë¦¬ë”ì˜ ê±´ê°•ê¹Œì§€ ìƒê°í•˜ëŠ” ì¼€ë°€ë¦¬ ğŸ¶</p>
                </div>
            `;
        lucide.createIcons();
      }

      function rotateTip() {
        const btn = document.getElementById("refresh-icon");
        btn.classList.add("animate-spin");
        document.getElementById("care-section").classList.add("opacity-50");

        setTimeout(() => {
          const randomIndex = Math.floor(Math.random() * careTips.length);
          renderCareTip(randomIndex);
          btn.classList.remove("animate-spin");
          document
            .getElementById("care-section")
            .classList.remove("opacity-50");
        }, 500);
      }

      document.addEventListener("DOMContentLoaded", () => {
        document.getElementById("current-date").innerText =
          new Date().toLocaleDateString();
        document.getElementById("mascot-small").innerHTML = getPuppySVG(
          "happy",
          35
        );
        document.getElementById("mascot-dashboard").innerHTML = getPuppySVG(
          "smart",
          48
        );
        document.getElementById("mascot-care").innerHTML = getPuppySVG(
          "sleepy",
          28
        );

        renderCareTip(0);
        renderFairness();
        lucide.createIcons();
      });

      function toggleSidebar() {
        const sidebar = document.getElementById("sidebar");
        sidebar.classList.toggle("hidden");
        sidebar.classList.toggle("absolute");
        sidebar.classList.toggle("z-50");
        sidebar.classList.toggle("h-full");
      }

      /* ===============================
           í•™ìƒ ê´€ë¦¬(ì—‘ì…€) ê¸°ëŠ¥ ìŠ¤í¬ë¦½íŠ¸
           ì›ë³¸ practice_for_excel_inputation ê·¸ëŒ€ë¡œ ì´ì‹
           =============================== */
      const addButton = document.getElementById("add-student-button");
      const addBulkButton = document.getElementById("add-bulk-button");
      const clearButton = document.getElementById("clear-fields-button");
      const statusText = document.getElementById("status-text");
      const studentCountBadge = document.getElementById("student-count-badge");
      const studentListBody = document.getElementById("student-list-body");
      const excelBulkInputArea = document.getElementById(
        "excel-bulk-input-area"
      );
      const excelFileInput = document.getElementById("excel-file-input");

      const downloadXlsxBtn = document.getElementById("download-xlsx-btn");
      const downloadCsvBtn = document.getElementById("download-csv-btn");

      const fields = {
        name: document.getElementById("student-name-input"),
        parentPhone: document.getElementById("parent-phone-input"),
        studentPhone: document.getElementById("student-phone-input"),
        highschoolName: document.getElementById("highschool-name-input"),
        grade: document.getElementById("grade-select"),
        track: document.getElementById("track-select"),
        gender: document.getElementById("gender-select"),
        password: document.getElementById("password-input"),
      };

      function makeSchoolGrade(highschoolName, grade) {
        if (highschoolName && grade) return highschoolName + " " + grade;
        if (highschoolName) return highschoolName;
        return grade || "-";
      }

      function updateCount() {
        const count = studentListBody.querySelectorAll("tr").length;
        studentCountBadge.textContent = count + "ëª…";
        statusText.textContent =
          count === 0
            ? "ì•„ì§ ì¶”ê°€ëœ í•™ìƒì´ ì—†ìŠµë‹ˆë‹¤."
            : count + "ëª…ì˜ í•™ìƒì´ ë¦¬ìŠ¤íŠ¸ì— ìˆìŠµë‹ˆë‹¤.";
      }

      function clearFields() {
        Object.values(fields).forEach((el) =>
          el.tagName === "SELECT" ? (el.value = "") : (el.value = "")
        );
      }

      function addStudentRow({
        name,
        parentPhone,
        studentPhone,
        highschoolName,
        grade,
        track,
        gender,
        password,
      }) {
        if (!name || !parentPhone || !password) return false;
        const tr = document.createElement("tr");
        tr.innerHTML = `
            <td>${name}</td>
            <td>${parentPhone}</td>
            <td>${studentPhone || "-"}</td>
            <td>${makeSchoolGrade(highschoolName, grade)}</td>
            <td>${track || "-"}</td>
            <td>${gender || "-"}</td>
            <td>${password ? "****" : "-"}</td>
          `;
        studentListBody.appendChild(tr);
        return true;
      }

      // ê°œë³„ ì…ë ¥ â†’ ì¶”ê°€
      addButton.addEventListener("click", function (e) {
        e.preventDefault();
        const name = fields.name.value.trim();
        const parentPhone = fields.parentPhone.value.trim();
        const studentPhone = fields.studentPhone.value.trim();
        const highschoolName = fields.highschoolName.value.trim();
        const grade = fields.grade.value;
        const track = fields.track.value;
        const gender = fields.gender.value;
        const password = fields.password.value.trim();

        if (!name || !parentPhone || !password) {
          alert("ì´ë¦„ / ë¶€ëª¨ë‹˜ ì „í™” / ë¹„ë°€ë²ˆí˜¸ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.");
          return;
        }
        const ok = addStudentRow({
          name,
          parentPhone,
          studentPhone,
          highschoolName,
          grade,
          track,
          gender,
          password,
        });
        if (ok) {
          updateCount();
          clearFields();
        }
      });

      clearButton.addEventListener("click", clearFields);

      // ë¶™ì—¬ë„£ê¸° ì¼ê´„ ì¶”ê°€ (íƒ­ ë˜ëŠ” ì½¤ë§ˆ êµ¬ë¶„)
      addBulkButton.addEventListener("click", function () {
        const text = excelBulkInputArea.value.trim();
        if (!text) return;
        let cnt = 0,
          failed = 0;
        const lines = text.replace(/\r\n/g, "\n").split("\n");
        for (let row of lines) {
          if (!row.trim()) continue;
          let cells = row.split("\t").map((x) => x.trim());
          if (cells.length === 1) cells = row.split(",").map((x) => x.trim());

          const [
            name,
            parentPhone,
            studentPhone,
            highschoolName,
            grade,
            track,
            gender,
            password,
          ] = cells.map((s) => (s || "").trim());

          if (!name || !parentPhone || !password) {
            failed++;
            continue;
          }

          addStudentRow({
            name,
            parentPhone,
            studentPhone,
            highschoolName,
            grade,
            track,
            gender,
            password,
          });
          cnt++;
        }
        updateCount();
        alert(
          `${cnt}ëª… ì¶”ê°€${
            failed ? ` / ${failed}ëª…(í˜•ì‹ ì˜¤ë¥˜ ë˜ëŠ” í•„ìˆ˜ê°’ ì—†ìŒ)` : ""
          }`
        );
        excelBulkInputArea.value = "";
      });

      // í˜„ì¬ í…Œì´ë¸” ë°ì´í„°ë¥¼ 2ì°¨ì› ë°°ì—´ë¡œ ì¶”ì¶œ
      function getTableData() {
        return Array.from(studentListBody.children).map((tr) =>
          Array.from(tr.children).map((td) => td.innerText)
        );
      }

      // CSV / XLSX ë‹¤ìš´ë¡œë“œ
      function downloadCSV(headers, data) {
        let csv =
          headers.join(",") +
          "\r\n" +
          data
            .map((row) =>
              row
                .map((cell) => `"${(cell || "").replace(/"/g, '""')}"`)
                .join(",")
            )
            .join("\r\n");
        const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
        const a = document.createElement("a");
        a.href = URL.createObjectURL(blob);
        a.download = "í•™ìƒë¦¬ìŠ¤íŠ¸.csv";
        document.body.appendChild(a);
        a.click();
        a.remove();
      }

      function downloadXLSX(headers, data) {
        const ws = XLSX.utils.aoa_to_sheet([headers, ...data]);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "í•™ìƒë¦¬ìŠ¤íŠ¸");
        XLSX.writeFile(wb, "í•™ìƒë¦¬ìŠ¤íŠ¸.xlsx");
      }

      downloadCsvBtn.addEventListener("click", function () {
        const headers = [
          "ì´ë¦„",
          "ë¶€ëª¨",
          "í•™ìƒí°",
          "í•™êµ/í•™ë…„",
          "ê³„ì—´",
          "ì„±ë³„",
          "ë¹„ë²ˆ",
        ];
        const data = getTableData();
        downloadCSV(headers, data);
      });

      downloadXlsxBtn.addEventListener("click", function () {
        const headers = [
          "ì´ë¦„",
          "ë¶€ëª¨",
          "í•™ìƒí°",
          "í•™êµ/í•™ë…„",
          "ê³„ì—´",
          "ì„±ë³„",
          "ë¹„ë²ˆ",
        ];
        const data = getTableData();
        downloadXLSX(headers, data);
      });

      // âœ… ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ â†’ ìë™ íŒŒì‹± â†’ í–‰ ì¶”ê°€
      excelFileInput.addEventListener("change", function (e) {
        const file = e.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = function (evt) {
          const data = new Uint8Array(evt.target.result);
          const workbook = XLSX.read(data, { type: "array" });
          const sheetName = workbook.SheetNames[0];
          const sheet = workbook.Sheets[sheetName];

          const rows = XLSX.utils.sheet_to_json(sheet, { defval: "" });

          let cnt = 0;
          rows.forEach((row) => {
            const name =
              row["í•™ìƒ ì´ë¦„ (í•„ìˆ˜)"] || row["ì´ë¦„"] || row["name"] || "";
            const parentPhone =
              row["ë¶€ëª¨ë‹˜ ì „í™”ë²ˆí˜¸ (í•„ìˆ˜)."] ||
              row["ë¶€ëª¨ë‹˜ ì „í™”ë²ˆí˜¸ (í•„ìˆ˜)"] ||
              row["ë¶€ëª¨ì „í™”"] ||
              row["ë¶€ëª¨"] ||
              row["parent"] ||
              "";
            const studentPhone =
              row["í•™ìƒ ì „í™”ë²ˆí˜¸ (ì„ íƒ)"] ||
              row["í•™ìƒì „í™”"] ||
              row["í•™ìƒí°"] ||
              row["student"] ||
              "";
            const highschoolName =
              row["ê³ ë“±í•™êµ ì´ë¦„ (ì„ íƒ)"] ||
              row["í•™êµ"] ||
              row["í•™êµëª…"] ||
              row["school"] ||
              "";
            const grade =
              row["í•™ë…„ (ì„ íƒ)"] || row["í•™ë…„"] || row["grade"] || "";
            const track =
              row["ê³„ì—´ (ì„ íƒ)"] || row["ê³„ì—´"] || row["track"] || "";
            const gender =
              row["ì„±ë³„ (ì„ íƒ)"] || row["ì„±ë³„"] || row["gender"] || "";
            const password =
              row["ì´ˆê¸° ë¹„ë°€ë²ˆí˜¸ (í•„ìˆ˜)\ní•™ìƒì´ ë¡œê·¸ì¸ í•  ë¹„ë°€ë²ˆí˜¸ì…ë‹ˆë‹¤."] ||
              row["ì´ˆê¸° ë¹„ë°€ë²ˆí˜¸ (í•„ìˆ˜)"] ||
              row["ë¹„ë°€ë²ˆí˜¸"] ||
              row["ë¹„ë²ˆ"] ||
              row["password"] ||
              "";

            if (!name || !parentPhone || !password) return;

            const ok = addStudentRow({
              name,
              parentPhone,
              studentPhone,
              highschoolName,
              grade,
              track,
              gender,
              password,
            });
            if (ok) cnt++;
          });

          updateCount();
          alert(cnt + "ëª… ì—‘ì…€ì—ì„œ ì¶”ê°€ ì™„ë£Œ");
          excelFileInput.value = "";
        };

        reader.readAsArrayBuffer(file);
      });

      updateCount();
    </script>
  </body>
</html>
